<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aura Fugaz Beauty</title>
  <style>
    /* Reset básico */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Quicksand', sans-serif;
      background: #1e1b26;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Quicksand:wght@400;600&display=swap');
    header {
      background: linear-gradient(90deg, #8e44ad, #f1c6d4);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 1000;
      flex-wrap: wrap;
      gap: 1rem;
    }
    #logo {
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
    }
    nav#menu-categorias {
      display: flex;
      gap: 1rem;
      align-items: center;
      font-weight: 700;
      position: relative;
    }
    nav#menu-categorias button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 1rem;
      position: relative;
      padding: 0.3rem 0.6rem;
      border-radius: 8px;
      transition: background 0.3s;
    }
    nav#menu-categorias button:hover {
      background: rgba(255,255,255,0.2);
    }
    .submenu {
      display: none;
      position: absolute;
      background: #8e44ad;
      padding: 0.5rem;
      border-radius: 8px;
      top: 2.5rem;
      left: 0;
      flex-direction: column;
      gap: 0.5rem;
      min-width: 130px;
      z-index: 1500;
    }
    .submenu button {
      color: white;
      font-weight: 400;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      text-align: left;
      padding: 0.3rem 0.5rem;
      border-radius: 6px;
      transition: background 0.3s;
    }
    .submenu button:hover {
      background: rgba(255,255,255,0.3);
    }
    .redes-sociales {
      display: flex;
      gap: 1rem;
    }
    .redes-sociales img {
      width: 28px;
      cursor: pointer;
      filter: drop-shadow(0 0 1px #000);
      transition: transform 0.2s;
    }
    .redes-sociales img:hover {
      transform: scale(1.1);
    }
    .productos-container {
      padding: 1rem;
      flex-grow: 1;
      overflow-y: auto;
    }
    .categoria {
      margin-bottom: 2rem;
    }
    .categoria h2 {
      color: #f1c6d4;
      margin-bottom: 0.5rem;
      font-family: 'Cinzel Decorative', serif;
      font-weight: 700;
      font-size: 1.5rem;
    }
    .productos {
      display: flex;
      overflow-x: auto;
      gap: 1rem;
      scroll-snap-type: x mandatory;
      padding-bottom: 0.5rem;
    }
    .producto {
      background: white;
      color: #2e2a47;
      border-radius: 8px;
      min-width: 180px;
      cursor: pointer;
      scroll-snap-align: start;
      flex-shrink: 0;
      box-shadow: 0 0 15px rgba(255,255,255,0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.5rem;
      transition: transform 0.3s;
      user-select: none;
      position: relative;
    }
    .producto:hover {
      transform: scale(1.05);
      z-index: 100;
    }
    .producto img {
      border-radius: 8px;
      width: 100%;
      height: 120px;
      object-fit: cover;
    }
    .producto h3 {
      margin-top: 0.5rem;
      font-size: 1rem;
      text-align: center;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    #modal-content {
      background: white;
      color: #2e2a47;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      position: relative;
    }
    #modal-img {
      width: 100%;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 1rem;
    }
    .cantidad-control {
      margin: 1rem 0;
      display: flex;
      justify-content: center;
      gap: 1rem;
      align-items: center;
      font-weight: 700;
    }
    .cantidad-control button {
      font-size: 1.5rem;
      background: #8e44ad;
      border: none;
      color: white;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      cursor: pointer;
      user-select: none;
    }
    #modal-add-btn {
      background: #8e44ad;
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      font-weight: 700;
      cursor: pointer;
      border-radius: 8px;
      width: 100%;
      margin-top: 0.5rem;
    }
    #modal-add-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .cerrar-btn {
      margin-top: 0.5rem;
      background: #f1c6d4;
      border: none;
      color: #2e2a47;
      padding: 0.4rem 1rem;
      cursor: pointer;
      border-radius: 8px;
      width: 100%;
      font-weight: 700;
    }

    /* Carrito flotante */
    #carritoFlotante {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 320px;
      max-height: 480px;
      background: white;
      color: #2e2a47;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.6);
      overflow-y: auto;
      z-index: 1500;
      display: none;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    #carritoFlotante h3 {
      margin-bottom: 0.5rem;
      font-family: 'Cinzel Decorative', serif;
      font-weight: 700;
      color: #8e44ad;
    }
    #carritoItems {
      list-style: none;
      padding: 0;
      margin: 0;
      flex-grow: 1;
      overflow-y: auto;
    }
    #carritoItems li {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.5rem;
    }
    #carritoItems img {
      width: 50px;
      border-radius: 6px;
      flex-shrink: 0;
    }
    #carritoItems div {
      flex-grow: 1;
      font-weight: 600;
    }
    .quitar {
      background: none;
      border: none;
      color: #8e44ad;
      font-size: 1.2rem;
      cursor: pointer;
      font-weight: bold;
      flex-shrink: 0;
    }
    #totalCarrito {
      font-weight: 700;
      margin-top: 0.5rem;
      border-top: 1px solid #ccc;
      padding-top: 0.5rem;
      text-align: right;
      font-size: 1.1rem;
      color: #8e44ad;
    }
    #nombreCliente, #ciudadCliente, #metodoPago {
      width: 100%;
      margin-top: 0.8rem;
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      color: #2e2a47;
      font-weight: 600;
      font-size: 1rem;
    }
    #btnWhatsapp {
      display: block;
      width: 100%;
      margin-top: 1rem;
      background: #25d366;
      color: white;
      font-weight: 700;
      padding: 0.7rem;
      border-radius: 12px;
      text-align: center;
      text-decoration: none;
      cursor: pointer;
      font-size: 1.1rem;
      user-select: none;
    }
    #btnWhatsapp:disabled,
    #btnWhatsapp[href="#"] {
      background: #ccc;
      cursor: not-allowed;
    }

    /* Botón carrito */
    #boton-carrito {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #f1c6d4;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 2rem;
      color: #2e2a47;
      cursor: pointer;
      z-index: 1600;
      box-shadow: 0 0 10px #f1c6d4;
      user-select: none;
    }

    /* Responsive */
    @media (max-width: 768px) {
      nav#menu-categorias {
        width: 100%;
        justify-content: center;
        gap: 1.5rem;
      }
      .submenu {
        position: static;
        display: none;
        background: transparent;
        flex-wrap: wrap;
        gap: 0.5rem;
        padding: 0;
      }
      .submenu.show {
        display: flex !important;
      }
      .producto {
        min-width: 140px;
      }
      #carritoFlotante {
        width: 90vw;
        right: 5vw;
        bottom: 70px;
        max-height: 50vh;
      }
      header {
        justify-content: center;
        gap: 0.8rem;
      }
      #logo {
        height: 40px;
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="https://i.imgur.com/Y5DPUUl.png" alt="Logo Aura Fugaz Beauty" id="logo" title="Aura Fugaz Beauty" />
    <nav id="menu-categorias">
      <button onclick="toggleSubMenu('maquillaje-sub')">Maquillaje ▾</button>
      <div id="maquillaje-sub" class="submenu">
        <button onclick="scrollToCategoria('labiales')">Labiales</button>
        <button onclick="scrollToCategoria('sombras')">Sombras</button>
      </div>
      <button onclick="scrollToCategoria('skincare')">Skin Care</button>
      <button onclick="scrollToCategoria('otros')">Otros</button>
    </nav>
    <div class="redes-sociales">
      <a href="https://instagram.com/tuusuario" target="_blank" rel="noopener noreferrer"><img src="https://i.imgur.com/CHXx3MG.png" alt="Instagram" title="Instagram" /></a>
      <a href="https://facebook.com/tuusuario" target="_blank" rel="noopener noreferrer"><img src="https://i.imgur.com/2yoWRQe.png" alt="Facebook" title="Facebook" /></a>
      <a href="https://wa.me/1234567890" target="_blank" rel="noopener noreferrer"><img src="https://i.imgur.com/ee6eF0K.png" alt="WhatsApp" title="WhatsApp" /></a>
    </div>
  </header>

  <main class="productos-container" id="productosContainer"></main>

  <!-- Modal producto -->
  <div id="modal" class="modal" onclick="if(event.target===this) cerrarModal()">
    <div id="modal-content" role="dialog" aria-modal="true" aria-labelledby="modal-nombre">
      <h3 id="modal-nombre"></h3>
      <img id="modal-img" src="" alt="" title="Toca para cambiar imagen" />
      <select id="modal-tonos" aria-label="Seleccionar tono"></select>
      <div class="cantidad-control" aria-label="Seleccionar cantidad">
        <button onclick="cambiarCantidad(-1)" aria-label="Disminuir cantidad">-</button>
        <span id="modal-cantidad" aria-live="polite" aria-atomic="true">1</span>
        <button onclick="cambiarCantidad(1)" aria-label="Aumentar cantidad">+</button>
      </div>
      <button id="modal-add-btn" onclick="agregarAlCarrito()">Agregar al carrito</button>
      <button onclick="cerrarModal()" class="cerrar-btn">Cerrar</button>
    </div>
  </div>

  <!-- Carrito flotante -->
  <div id="carritoFlotante" aria-live="polite" aria-label="Carrito de compras">
    <h3>🛒 Tu carrito</h3>
    <ul id="carritoItems"></ul>
    <p id="totalCarrito"></p>
    <input type="text" id="nombreCliente" placeholder="Tu nombre" aria-label="Nombre del cliente" />
    <select id="ciudadCliente" aria-label="Seleccionar ciudad">
      <option value="" disabled selected>Selecciona tu ciudad</option>
      <option value="Quito" data-envio="2.5">Quito - Envío $2.50</option>
      <option value="Guayaquil" data-envio="3.0">Guayaquil - Envío $3.00</option>
      <option value="Cuenca" data-envio="2.0">Cuenca - Envío $2.00</option>
    </select>
    <select id="metodoPago" aria-label="Método de pago">
      <option value="" disabled selected>Selecciona método de pago</option>
      <option value="Efectivo">Efectivo</option>
      <option value="Tarjeta">Tarjeta</option>
      <option value="Transferencia">Transferencia</option>
    </select>
    <a id="btnWhatsapp" href="#" target="_blank" class="btn-whatsapp" aria-disabled="true" tabindex="-1">Enviar por WhatsApp</a>
  </div>

  <button id="boton-carrito" onclick="toggleCarrito()" aria-label="Mostrar u ocultar carrito">🛒</button>

  <script>
    const productosData = {
      labiales: [
        {
          nombre: "Labial Rojo Intenso",
          precio:2.5,
          tonos: { 
            Rojo: {stock : 5, imagen:
              "r1.jpg"},
            Coral: {stock : 3,imagen: 
              "r2.jpg" }
        },
        {
          nombre: "Labial Nude Suave",
          imagenes: [
            "https://i.imgur.com/LjiIqK6.jpg",
            "https://i.imgur.com/x4Ox4Zf.jpg"
          ],
          tonos: { Nude: 4, Beige: 2 }
        }
      ],
      sombras: [
        {
          nombre: "Paleta Sombras Neutras",
          imagenes: [
            "https://i.imgur.com/4kzGJoW.jpg",
            "https://i.imgur.com/9wCnVvf.jpg"
          ],
          tonos: { "Tonos Neutros": 10 }
        },
        {
          nombre: "Paleta Sombras Color",
          imagenes: [
            "https://i.imgur.com/Pl1QF6q.jpg",
            "https://i.imgur.com/3uUkjqR.jpg"
          ],
          tonos: { "Tonos Vibrantes": 6 }
        }
      ],
      skincare: [
        {
          nombre: "Crema Hidratante",
          imagenes: [
            "https://i.imgur.com/QCTctyS.jpg"
          ],
          tonos: { "Único": 20 }
        }
      ],
      otros: [
        {
          nombre: "Esponja Maquillaje",
          imagenes: [
            "https://i.imgur.com/TeXn6Rv.jpg"
          ],
          tonos: { "Único": 15 }
        }
      ]
    };

    let productoActual = null;
    let cantidadModal = 1;
    let imagenIndex = 0;
    let carrito = [];

    // Crear productos en DOM
    function crearProductos() {
      const contenedor = document.getElementById("productosContainer");
      contenedor.innerHTML = "";

      for (const categoria in productosData) {
        const divCat = document.createElement("div");
        divCat.className = "categoria";
        divCat.id = categoria;
// Título categoría (capitalizar)
        const titulo = document.createElement("h2");
        titulo.textContent = categoria.charAt(0).toUpperCase() + categoria.slice(1);
        divCat.appendChild(titulo);

        // Carrusel productos
        const carrusel = document.createElement("div");
        carrusel.className = "productos";

        productosData[categoria].forEach((producto, idx) => {
          const prodDiv = document.createElement("div");
          prodDiv.className = "producto";
          prodDiv.innerHTML = `
            <img src="${producto.imagenes[0]}" alt="${producto.nombre}" />
            <h3>${producto.nombre}</h3>
          `;
          prodDiv.onclick = () => abrirModal(categoria, idx);
          carrusel.appendChild(prodDiv);
        });

        divCat.appendChild(carrusel);
        contenedor.appendChild(divCat);
      }
    }

    // Abrir modal con producto seleccionado
    function abrirModal(categoria, index) {
      productoActual = productosData[categoria][index];
      cantidadModal = 1;
      imagenIndex = 0;

      document.getElementById("modal-nombre").textContent = productoActual.nombre;
      actualizarImagenModal();
      actualizarTonosModal();
      actualizarCantidadModal();

      document.getElementById("modal").style.display = "flex";
    }

    // Actualizar imagen en modal (clic para cambiar)
    function actualizarImagenModal() {
      const img = document.getElementById("modal-img");
      img.src = productoActual.imagenes[imagenIndex];
      img.alt = productoActual.nombre + " imagen " + (imagenIndex + 1);

      img.onclick = () => {
        imagenIndex = (imagenIndex + 1) % productoActual.imagenes.length;
        actualizarImagenModal();
      };
    }

    // Actualizar opciones de tonos en modal
    function actualizarTonosModal() {
      const select = document.getElementById("modal-tonos");
      select.innerHTML = "";
      for (const tono in productoActual.tonos) {
        if (productoActual.tonos[tono] > 0) {
          const opt = document.createElement("option");
          opt.value = tono;
          opt.textContent = `${tono} (${productoActual.tonos[tono]} disponibles)`;
          select.appendChild(opt);
        }
      }

      if (select.options.length === 0) {
        select.innerHTML = `<option disabled>No hay tonos disponibles</option>`;
        document.getElementById("modal-add-btn").disabled = true;
      } else {
        document.getElementById("modal-add-btn").disabled = false;
      }
      select.onchange = actualizarCantidadModal;
    }

    // Actualizar cantidad visible y controlar límites
    function actualizarCantidadModal() {
      const span = document.getElementById("modal-cantidad");
      const select = document.getElementById("modal-tonos");
      let tonoSel = select.value;
      if (!tonoSel && select.options.length > 0) tonoSel = select.options[0].value;
      let max = productoActual.tonos[tonoSel] || 0;
      if (cantidadModal < 1) cantidadModal = 1;
      if (cantidadModal > max) cantidadModal = max;
      span.textContent = cantidadModal;
    }

    // Cambiar cantidad con botones + y -
    function cambiarCantidad(val) {
      cantidadModal += val;
      actualizarCantidadModal();
    }

    // Agregar producto seleccionado al carrito
    function agregarAlCarrito() {
      const select = document.getElementById("modal-tonos");
      const tono = select.value;
      if (!tono) {
        alert("Selecciona un tono válido.");
        return;
      }
      const stock = productoActual.tonos[tono];
      if (cantidadModal > stock) {
        alert("No hay suficiente stock disponible.");
        return;
      }

      // Buscar si ya existe producto-tono en carrito
      const idx = carrito.findIndex(item => item.nombre === productoActual.nombre && item.tono === tono);
      if (idx >= 0) {
        if (carrito[idx].cantidad + cantidadModal > stock) {
          alert("No hay suficiente stock para esa cantidad.");
          return;
        }
        carrito[idx].cantidad += cantidadModal;
      } else {
        carrito.push({
          nombre: productoActual.nombre,
          tono,
          cantidad: cantidadModal,
          img: productoActual.imagenes[0]
        });
      }

      // Actualizar stock en productosData
      productoActual.tonos[tono] -= cantidadModal;

      cerrarModal();
      actualizarProductos();
      actualizarCarrito();
    }

    // Cerrar modal
    function cerrarModal() {
      document.getElementById("modal").style.display = "none";
    }

    // Actualizar stock visible en lista productos y modal si abierto
    function actualizarProductos() {
      // Volver a crear productos para actualizar stock en opciones de tonos
      crearProductos();
      if (document.getElementById("modal").style.display === "flex" && productoActual) {
        actualizarTonosModal();
        actualizarCantidadModal();
      }
    }

    // Actualizar carrito visible
    function actualizarCarrito() {
      const ul = document.getElementById("carritoItems");
      ul.innerHTML = "";
      if(carrito.length === 0){
        ul.innerHTML = "<li>Tu carrito está vacío.</li>";
      }

      let totalItems = 0;
      carrito.forEach((item, idx) => {
        totalItems += item.cantidad;
        const li = document.createElement("li");

        li.innerHTML = `
          <img src="${item.img}" alt="${item.nombre}" />
          <div>
            ${item.nombre} <br />
            <small>Tono: ${item.tono}</small> <br />
            <small>Cantidad: ${item.cantidad}</small>
          </div>
          <button class="quitar" aria-label="Quitar ${item.nombre} tono ${item.tono}" onclick="quitarDelCarrito(${idx})">×</button>
        `;
        ul.appendChild(li);
      });

      document.getElementById("totalCarrito").textContent = `Total de productos: ${totalItems}`;
      actualizarBotonWhatsApp();
    }

    // Quitar producto del carrito
    function quitarDelCarrito(idx) {
      const item = carrito[idx];
      // Devolver stock
      for (const categoria in productosData) {
        for (const prod of productosData[categoria]) {
          if(prod.nombre === item.nombre && prod.tonos[item.tono] !== undefined) {
            prod.tonos[item.tono] += item.cantidad;
          }
        }
      }
      carrito.splice(idx, 1);
      actualizarProductos();
      actualizarCarrito();
    }

    // Mostrar u ocultar carrito
    function toggleCarrito() {
      const carritoDiv = document.getElementById("carritoFlotante");
      if(carritoDiv.style.display === "flex") {
        carritoDiv.style.display = "none";
      } else {
        carritoDiv.style.display = "flex";
      }
    }

    // Enviar pedido por WhatsApp
    function actualizarBotonWhatsApp() {
      const btn = document.getElementById("btnWhatsapp");
      const nombre = document.getElementById("nombreCliente").value.trim();
      const ciudadSelect = document.getElementById("ciudadCliente");
      const ciudad = ciudadSelect.value;
      const metodoPago = document.getElementById("metodoPago").value;

      if(carrito.length === 0 || !nombre || !ciudad || !metodoPago) {
        btn.href = "#";
        btn.setAttribute("aria-disabled", "true");
        btn.tabIndex = -1;
        return;
      }

      let envio = 0;
      for(let i=0; i<ciudadSelect.options.length; i++) {
        if(ciudadSelect.options[i].value === ciudad) {
          envio = parseFloat(ciudadSelect.options[i].dataset.envio);
          break;
        }
      }

      let mensaje = `Hola, soy *${nombre}* y quiero hacer un pedido de Aura Fugaz Beauty.%0A%0A`;
      carrito.forEach(item => {
        mensaje += `- ${item.nombre} (Tono: ${item.tono}) x${item.cantidad}%0A`;
      });
      mensaje += `%0AEnvío a: ${ciudad} (Costo: $${envio.toFixed(2)})%0A`;
      mensaje += `Método de pago: ${metodoPago}%0A`;
      mensaje += `%0ATotal a pagar: $${(carrito.reduce((acc,i) => acc + i.cantidad * 5, 0) + envio).toFixed(2)}%0A`;
      mensaje += `%0A¡Gracias! 😊`;

      btn.href = `https://wa.me/1234567890?text=${mensaje}`;
      btn.removeAttribute("aria-disabled");
      btn.tabIndex = 0;
    }

    // Scroll a la categoría en página
    function scrollToCategoria(id) {
      const el = document.getElementById(id);
      if(el){
        el.scrollIntoView({behavior: "smooth", block: "start"});
      }
      // Cerrar submenu maquillaje si está abierto
      const submenu = document.getElementById("maquillaje-sub");
      if(submenu.classList.contains("show")){
        submenu.classList.remove("show");
      }
    }

    // Toggle submenu maquillaje
    function toggleSubMenu(id) {
      const submenu = document.getElementById(id);
      submenu.classList.toggle("show");
    }

    // Eventos para actualizar botón WhatsApp cuando cambian inputs
    document.getElementById("nombreCliente").addEventListener("input", actualizarBotonWhatsApp);
    document.getElementById("ciudadCliente").addEventListener("change", actualizarBotonWhatsApp);
    document.getElementById("metodoPago").addEventListener("change", actualizarBotonWhatsApp);

    // Cerrar submenu al click fuera
    document.addEventListener("click", (e) => {
      const submenu = document.getElementById("maquillaje-sub");
      const boton = e.target.closest("nav#menu-categorias > button");
      if(!submenu.contains(e.target) && !boton){
        submenu.classList.remove("show");
      }
    });

    // Inicializar página
    crearProductos();
    actualizarCarrito();
  </script>
</body>
</html>
