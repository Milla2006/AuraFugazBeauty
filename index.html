<!doctype html>

<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aura Fugaz — Tienda (Temu style)</title>
  <style>
  body.loaded #splash {
      display: none;
    }
    body:not(.loaded) main, 
    body:not(.loaded) header, 
    body:not(.loaded) nav, 
    body:not(.loaded) footer, 
    body:not(.loaded) .app {
      display: none;
    }
    #splash {
      position: fixed; 
      top: 0; left: 0; right: 0; bottom: 0; 
      background: #000; 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      z-index: 9999;
    }
    #splash img {
      max-width: 80%; 
      max-height: 80%;
    }
    /* --------- Paleta y base --------- */
    :root{
      --lila-suave:#dcc7ef; /* fondo */
      --morado-oscuro:#6b5a80; /* acentos */
      --negro-elegante:#0b0b0b; /* texto */
      --blanco:#ffffff; /* tarjetas */
      --rosa:#f6c1e6; /* detalles */
      --card-shadow: 0 8px 20px rgba(11,11,11,0.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:linear-gradient(180deg,var(--lila-suave),#f7eef8);color:var(--negro-elegante)}/* Header tipo app (logo centrado + buscador) */
header.app-header{
  position:sticky;top:0;z-index:40;background:linear-gradient(90deg,var(--morado-oscuro),#7c67a3);padding:10px 12px;display:flex;align-items:center;gap:12px;justify-content:space-between;
  box-shadow:0 6px 20px rgba(0,0,0,0.12);
  border-bottom-left-radius:12px;border-bottom-right-radius:12px;color:var(--blanco)
}
.logo{margin:auto;text-align:center;font-weight:700;font-size:1.15rem;letter-spacing:1px}
.logo .brand-small{display:block;font-family:'Cinzel Decorative', serif;font-size:1.25rem}

.search-wrap{flex:1;max-width:520px;margin-left:10px}
.search-wrap input{width:100%;padding:10px 12px;border-radius:999px;border:2px solid rgba(255,255,255,0.18);outline:none}

/* Layout */
.app{
  max-width:1100px;margin:18px auto;padding:0 12px 80px;display:grid;grid-template-columns:260px 1fr;gap:18px;align-items:start
}

/* Menu lateral izquierda (categorías y subcategorías) */
nav.side-menu{background:rgba(255,255,255,0.9);backdrop-filter:blur(6px);padding:12px;border-radius:12px;border:1px solid rgba(11,11,11,0.06)}
nav h3{margin:6px 0 8px;font-family:'Cinzel Decorative', serif;color:var(--morado-oscuro)}
.cat{margin-bottom:8px}
.cat strong{display:block}
.subcat{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.subcat button{background:transparent;border:1px dashed rgba(107,90,128,0.12);padding:6px 10px;border-radius:999px;cursor:pointer}

/* Contenido principal */
main{display:flex;flex-direction:column;gap:18px}
.hero{display:flex;gap:12px;align-items:center}
.hero .banner{flex:1;background:linear-gradient(90deg,var(--morado-oscuro),#8a6fb2);color:var(--blanco);padding:18px;border-radius:12px;box-shadow:var(--card-shadow)}

/* Cada sección de subcategoría */
.seccion{background:transparent}
.seccion h2{font-family:'Cinzel Decorative', serif;margin:0 6px 8px;font-size:1.05rem;color:var(--morado-oscuro)}

/* Carrusel horizontal estilo Temu */
.carrusel-contenedor{position:relative}
.carrusel-track{display:flex;gap:12px;overflow-x:auto;padding:12px 8px;scroll-behavior:smooth}
.carrusel-track::-webkit-scrollbar{height:8px}
.carrusel-track::-webkit-scrollbar-thumb{background:rgba(11,11,11,0.12);border-radius:8px}

/* Tarjeta cuadrada tipo Temu */
.card{background:var(--blanco);min-width:150px;width:170px;border-radius:12px;padding:10px;border:1px solid rgba(11,11,11,0.06);box-shadow:var(--card-shadow);display:flex;flex-direction:column;gap:8px;align-items:center}
.media{width:150px;height:150px;border-radius:10px;overflow:hidden;border:1px solid rgba(11,11,11,0.06);display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#faf0ff)}
.media img{width:100%;height:100%;object-fit:cover}
.nombre{font-size:0.92rem;text-align:center;font-weight:600}
.precio{font-weight:700;color:var(--morado-oscuro)}
.estrellas{font-size:0.85rem;color:#ffb86b}
.acciones{display:flex;gap:8px;width:100%;align-items:center}
.btn{flex:1;padding:8px 8px;border-radius:10px;border:none;cursor:pointer}
.agregar{background:linear-gradient(90deg,var(--morado-oscuro),#8a67a0);color:var(--blanco);font-weight:700}
.detalles{background:transparent;border:1px solid rgba(11,11,11,0.06)}

/* Floating cart */
.cart-float{position:fixed;right:16px;bottom:18px;background:linear-gradient(90deg,var(--morado-oscuro),#7c67a3);color:var(--blanco);padding:12px;border-radius:999px;box-shadow:0 12px 30px rgba(0,0,0,0.18);z-index:60;display:flex;align-items:center;gap:10px;cursor:pointer}
.cart-float .count{background:var(--rosa);color:var(--morado-oscuro);padding:4px 8px;border-radius:999px;font-weight:700}

/* Modal carrito */
.overlay{position:fixed;inset:0;background:rgba(11,11,11,0.45);display:none;align-items:center;justify-content:center;z-index:80}
.cart-modal{width:min(680px,95%);max-height:86vh;overflow:auto;background:var(--blanco);border-radius:12px;padding:16px}
.cart-modal header{display:flex;justify-content:space-between;align-items:center}
.cart-items{display:flex;flex-direction:column;gap:10px;margin-top:8px}
.cart-item{display:flex;gap:8px;align-items:center;border-radius:10px;padding:8px;border:1px solid rgba(11,11,11,0.04)}
.cart-item img{width:60px;height:60px;object-fit:cover;border-radius:8px}
.qty-control{display:flex;gap:6px;align-items:center}
.small{font-size:0.85rem;color:#666}

/* Form dentro del carrito */
.form-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.form-row input,.form-row select{padding:8px;border-radius:8px;border:1px solid rgba(11,11,11,0.08);flex:1}
.totales{margin-top:12px;background:linear-gradient(180deg,#fff,#fbf7ff);padding:10px;border-radius:10px;border:1px solid rgba(11,11,11,0.04)}
.send-btn{margin-top:10px;padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,#ff7cc5,#8a67a0);color:#fff;font-weight:800;width:100%}

/* Responsive para móvil: una sola columna (sin side menu) */
@media(max-width:900px){
  .app{grid-template-columns:1fr;padding:12px}
  nav.side-menu{order:2}
}
.side-menu {
  position: fixed;
  top: 70px;
  left: -320px; /* oculto */
  width: 85%;
  max-width: 320px;
  height: calc(100vh - 70px);
  background: #222;
  color: var(--blanco);
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  transition: left 0.3s ease;
  z-index: 90;
  overflow-y: auto;
}

.side-menu.open {
  left: 12px; /* visible */
}
/* Botones flecha bonitos */
.btn-flecha {
  position: absolute;
  top: 45%;
  width: 38px;
  height: 38px;
  border-radius: 50%;
  border: 2px solid #c9a0d4; /* lila pastel */
  background: rgba(217, 160, 255, 0.3); /* semitransparente */
  color: #c9a0d4;
  font-size: 24px;
  line-height: 34px;
  text-align: center;
  cursor: pointer;
  user-select: none;
  transition: background-color 0.3s, color 0.3s, transform 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 8px #c9a0d4aa;
  z-index: 10;
}

.btn-flecha:hover:not(:disabled) {
  background: #c9a0d4;
  color: #2e003e; /* morado oscuro */
  transform: scale(1.15);
  box-shadow: 0 0 14px #c9a0d4ff;
}

.btn-flecha:disabled {
  opacity: 0.3;
  cursor: default;
}

.btn-flecha.left {
  left: 6px;
}

.btn-flecha.right {
  right: 6px;
}

  </style>
</head>
<body>
    <div id="splash">
    <img src="https://via.placeholder.com/400x300?text=Rellita+Beauty" alt="Rellita Beauty" />
  </div>
  <header class="app-header">
    <button id="abrir-menu" aria-label="Abrir menú" style="background:transparent;border:none;color:var(--blanco);font-size:1.2rem;cursor:pointer">☰</button>
    <div class="logo">
      <img src="Logo.png" alt= "Rellita beauty"/></div>
    <div class="search-wrap"><input id="search" placeholder="Buscar producto, tono, categoría..." /></div>
  </header>  <div class="app">
    <!-- SIDE MENU -->
    <nav class="side-menu" id="sideMenu">
      <h3>Categorías</h3>
      <div class="cat">
        <strong>Maquillaje</strong>
        <div class="subcat">
          <button data-sub="labiales">Labiales</button>
          <button data-sub="rubores">Rubores</button>
          <button data-sub="sombras">Sombras</button>
        </div>
      </div><div class="cat">
    <strong>Skin Care</strong>
    <div class="subcat">
      <button data-sub="limpieza">Limpieza</button>
      <button data-sub="hidratacion">Hidratación</button>
    </div>
  </div>

  <div class="cat"><strong>Accesorios</strong>
    <div class="subcat"><button data-sub="pinceles">Pinceles</button></div>
  </div>

  <hr />
  <small class="small">Tu ciudad y envío</small>
  <div style="margin-top:8px">
    <select id="citySelect">
      <option value="Quito">Quito</option>
      <option value="Guayaquil">Guayaquil</option>
      <option value="Cuenca">Cuenca</option>
      <option value="Otro">Otro</option>
    </select>
    <select id="methodSelect" style="margin-top:8px;width:100%">
      <option value="Servientrega">Servientrega</option>
      <option value="Cooperativa">Cooperativa</option>
      <option value="Recojo">Recojo en tienda</option>
    </select>
  </div>
</nav>

<!-- MAIN CONTENT -->
<main>
  <section class="hero">
    <div class="banner">
      <h1 style="margin:0">Bienvenida a Rellita Beauty</h1>
      <p style="margin:6px 0 0">Tienda creada con cariño para ti ♥.</p>
    </div>
  </section>

  <!-- SECCIONES CON CARRUSELES POR SUBCATEGORIA -->

  <section class="seccion" data-subsection="labiales">
  <h2>Labiales</h2>
  <div class="carrusel-contenedor" style="position:relative; overflow:hidden;">
    <button class="btn-flecha left" aria-label="Anterior" style="position:absolute;left:0;top:40%;z-index:10;" disabled>‹</button>
    
    <div class="carrusel-track" id="track-labiales" style="display:flex; flex-wrap: nowrap; gap:10px;">
     <div class="card" data-id="p1b" data-name="Gloss Floral - Pack" data-price="15" data-category="Maquillaje" data-subcategory="Labiales" style="flex:0 0 calc(50% - 5px);">
        <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Gloss+Pack" alt="Gloss Pack"></div>
        <div class="nombre">Gloss Pack</div>
        <div class="estrellas">★★★★☆ <span class="small">(4.5)</span></div>
        <div class="precio">$15.00</div>
        <div style="width:100%" class="acciones">
          <select class="tone-select"><option>Mix</option></select>
          <button class="btn agregar">Agregar</button>
        </div>
      </div>

      
      <div class="card" data-id="p1b" data-name="Gloss Floral - Pack" data-price="15" data-category="Maquillaje" data-subcategory="Labiales" style="flex:0 0 calc(50% - 5px);">
        <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Gloss+Pack" alt="Gloss Pack"></div>
        <div class="nombre">Gloss Pack</div>
        <div class="estrellas">★★★★☆ <span class="small">(4.5)</span></div>
        <div class="precio">$15.00</div>
        <div style="width:100%" class="acciones">
          <select class="tone-select"><option>Mix</option></select>
          <button class="btn agregar">Agregar</button>
        </div>
      </div>

      <div class="card" data-id="p1c" data-name="Gloss Extra" data-price="10" data-category="Maquillaje" data-subcategory="Labiales" style="flex:0 0 calc(50% - 5px); display:none;">
        <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Gloss+Extra" alt="Gloss Extra"></div>
        <div class="nombre">Gloss Extra</div>
        <div class="estrellas">★★★☆☆ <span class="small">(4.0)</span></div>
        <div class="precio">$10.00</div>
        <div style="width:100%" class="acciones">
          <select class="tone-select"><option>Rosa</option></select>
          <button class="btn agregar">Agregar</button>
        </div>
      </div>
      
      <!-- más productos, también ocultos inicialmente -->
    </div>
    
    <button class="btn-flecha right" aria-label="Siguiente" style="position:absolute;right:0;top:40%;z-index:10;">›</button>
  </div>
</section>

  <section class="seccion" data-subsection="rubores">
    <h2>Rubores</h2>
    <div class="carrusel-contenedor">
      <div class="carrusel-track" id="track-rubores">
        <div class="card" data-id="p2" data-name="Rubor en Barra - Victoria Key" data-price="12.75" data-category="Maquillaje" data-subcategory="Rubores">
          <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Victoria+Key" alt="Rubor Victoria Key"></div>
          <div class="nombre">Rubor en Barra - Victoria Key</div>
          <div class="estrellas">★★★★★ <span class="small">(4.9)</span></div>
          <div class="precio">$12.75</div>
          <div style="width:100%" class="acciones">
            <select class="tone-select"><option value="Peach">Peach</option><option value="Rose">Rose</option></select>
            <button class="btn agregar">Agregar</button>
          </div>
        </div>

        <div class="card" data-id="p2b" data-name="Rubor Mini" data-price="6.5" data-category="Maquillaje" data-subcategory="Rubores">
          <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Rubor+Mini" alt="Rubor Mini"></div>
          <div class="nombre">Rubor Mini</div>
          <div class="estrellas">★★★★☆ <span class="small">(4.6)</span></div>
          <div class="precio">$6.50</div>
          <div style="width:100%" class="acciones">
            <select class="tone-select"><option>Rosa</option></select>
            <button class="btn agregar">Agregar</button>
          </div>
        </div>

      </div>
    </div>
  </section>

  <section class="seccion" data-subsection="sombras">
    <h2>Sombras</h2>
    <div class="carrusel-contenedor">
      <div class="carrusel-track" id="track-sombras">
        <div class="card" data-id="p3" data-name="Sombra Gege Bear" data-price="9.25" data-category="Maquillaje" data-subcategory="Sombras">
          <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Gege+Bear" alt="Sombra Gege Bear"></div>
          <div class="nombre">Sombra Gege Bear</div>
          <div class="estrellas">★★★★★ <span class="small">(4.7)</span></div>
          <div class="precio">$9.25</div>
          <div style="width:100%" class="acciones">
            <select class="tone-select"><option>Rosado</option><option>Mauve</option></select>
            <button class="btn agregar">Agregar</button>
          </div>
        </div>

        <div class="card" data-id="p3b" data-name="Sombra Duo" data-price="11.5" data-category="Maquillaje" data-subcategory="Sombras">
          <div class="media"><img src="https://via.placeholder.com/300x300.png?text=Sombra+Duo" alt="Sombra Duo"></div>
          <div class="nombre">Sombra Duo</div>
          <div class="estrellas">★★★★☆ <span class="small">(4.4)</span></div>
          <div class="precio">$11.50</div>
          <div style="width:100%" class="acciones">
            <select class="tone-select"><option>Duo</option></select>
            <button class="btn agregar">Agregar</button>
          </div>
        </div>

      </div>
    </div>
  </section>


</main>

  </div>  <!-- FLOATING CART -->  <div class="cart-float" id="cartFloat" title="Abrir carrito">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" style="filter:drop-shadow(0 4px 8px rgba(0,0,0,0.18))">
      <path d="M6 6h13l-1.4 7H8.4L6 6z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
      <circle cx="10" cy="20.5" r="1.2" fill="white" />
      <circle cx="17" cy="20.5" r="1.2" fill="white" />
    </svg>
    <div style="font-weight:700">Carrito</div>
    <div class="count" id="cartCount">0</div>
  </div>  <!-- OVERLAY / MODAL CARRITO -->  <div class="overlay" id="overlay">
    <div class="cart-modal" role="dialog" aria-modal="true">
      <header>
        <h3>Tu pedido</h3>
        <button id="closeCart" style="background:transparent;border:none;font-size:1.3rem;cursor:pointer">✖</button>
      </header><div class="cart-items" id="cartItems"></div>

  <div class="form-row">
    <input id="customerName" placeholder="Tu nombre" />
    <input id="customerPhone" placeholder="Número (ej: 5939xxxxxxx)" />
  </div>

  <div class="form-row">
    <select id="citySelectModal">
      <option value="Quito">Quito</option>
      <option value="Guayaquil">Guayaquil</option>
      <option value="Cuenca">Cuenca</option>
      <option value="Otro">Otro</option>
    </select>
    <select id="methodSelectModal">
      <option value="Servientrega">Servientrega</option>
      <option value="Cooperativa">Cooperativa</option>
      <option value="Recojo">Recojo en tienda</option>
    </select>
  </div>

  <div class="totales" id="totalesBox">
    <div class="small">Subtotal: <strong id="subtotalVal">$0.00</strong></div>
    <div class="small">Envío: <strong id="shippingVal">$0.00</strong></div>
    <div style="margin-top:6px;font-size:1.1rem">Total: <strong id="totalVal">$0.00</strong></div>
  </div>

  <button class="send-btn" id="sendWhats">Enviar por WhatsApp</button>
</div>

  </div>
  <script>
    /**************************************************************************
     * DATOS: productos (usar tus productos reales)
     **************************************************************************/
    const PRODUCTS = [
      {id:'p1',name:'Gloss Floral',price:8.5,category:'Maquillaje',subcategory:'Labiales',img:'https://via.placeholder.com/600x600.png?text=Gloss+Floral',tones:['Rosa Claro','Rosa Intenso','Transparente']},
      {id:'p2',name:'Rubor en Barra - Victoria Key',price:12.75,category:'Maquillaje',subcategory:'Rubores',img:'https://via.placeholder.com/600x600.png?text=Victoria+Key',tones:['Peach','Rose']},
      {id:'p3',name:'Sombra Gege Bear',price:9.25,category:'Maquillaje',subcategory:'Sombras',img:'https://via.placeholder.com/600x600.png?text=Gege+Bear',tones:['Rosado','Mauve']}
    ];

    // Matriz de costos de envío por ciudad y método
    const SHIPPING_MATRIX = {
      Quito: {Servientrega:5, Cooperativa:4, Recojo:0},
      Guayaquil: {Servientrega:6, Cooperativa:5, Recojo:0},
      Cuenca: {Servientrega:5.5, Cooperativa:4.5, Recojo:0},
      Otro: {Servientrega:8, Cooperativa:7, Recojo:0}
    };

    /**************************************************************************
     * Helpers
     **************************************************************************/
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const format = v => '$' + parseFloat(v).toFixed(2);

    /**************************************************************************
     * Iniciar: enlazar botones "Agregar" y manejo de carrito
     **************************************************************************/
    const cart = {items:[]};

    function addToCart(productId, tone, qty=1){
      const prod = PRODUCTS.find(p=>p.id===productId);
      if(!prod) return;
      const key = productId+"::"+tone;
      const existing = cart.items.find(i=>i.key===key);
      if(existing){ existing.qty += qty; }
      else{ cart.items.push({key,keyProduct:productId,name:prod.name,tone,price:prod.price,qty, img:prod.img}); }
      refreshCartCount();
    }

    function refreshCartCount(){
      const total = cart.items.reduce((s,i)=>s+i.qty,0);
      $('#cartCount').textContent = total;
    }

    function renderCartModal(){
      const container = $('#cartItems'); container.innerHTML='';
      cart.items.forEach((it,idx)=>{
        const row = document.createElement('div'); row.className='cart-item';
        row.innerHTML = `
          <img src="${it.img}" alt="${it.name}">
          <div style="flex:1">
            <div style="font-weight:700">${it.name}</div>
            <div class="small">Tono: ${it.tone}</div>
            <div class="small">Precio unit: ${format(it.price)}</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;gap:6px">
            <div class="qty-control">
              <button data-idx="${idx}" class="decrease">−</button>
              <div>${it.qty}</div>
              <button data-idx="${idx}" class="increase">+</button>
            </div>
            <button data-idx="${idx}" class="remove small" style="background:transparent;border:none;color:#b33;cursor:pointer">Eliminar</button>
          </div>
        `;
        container.appendChild(row);
      });

      // Enlazar controles
      $$('.increase').forEach(b=>b.addEventListener('click',e=>{
        const i = +e.currentTarget.dataset.idx; cart.items[i].qty++; refreshCartCount(); renderCartModal(); updateTotals();
      }));
      $$('.decrease').forEach(b=>b.addEventListener('click',e=>{
        const i = +e.currentTarget.dataset.idx; if(cart.items[i].qty>1) cart.items[i].qty--; else cart.items.splice(i,1); refreshCartCount(); renderCartModal(); updateTotals();
      }));
      $$('.remove').forEach(b=>b.addEventListener('click',e=>{
        const i = +e.currentTarget.dataset.idx; cart.items.splice(i,1); refreshCartCount(); renderCartModal(); updateTotals();
      }));

      updateTotals();
    }

    function calcSubtotal(){ return cart.items.reduce((s,i)=>s + i.price * i.qty,0); }

    function getShipping(city,method){
      const cityObj = SHIPPING_MATRIX[city] || SHIPPING_MATRIX['Otro'];
      return cityObj[method] !== undefined ? cityObj[method] : 0;
    }

    function updateTotals(){
      const subtotal = calcSubtotal();
      const city = $('#citySelectModal').value;
      const method = $('#methodSelectModal').value;
      const shipping = cart.items.length ? getShipping(city,method) : 0;
      const total = subtotal + shipping;
      $('#subtotalVal').textContent = format(subtotal);
      $('#shippingVal').textContent = format(shipping);
      $('#totalVal').textContent = format(total);
    }

    /**************************************************************************
     * Enlazar botones "Agregar" desde cada card
     **************************************************************************/
    function attachAddButtons(){
      $$('.card').forEach(card=>{
        const id = card.dataset.id;
        const addBtn = card.querySelector('.agregar');
        addBtn.addEventListener('click',()=>{
          const tone = card.querySelector('.tone-select')?.value || '';
          addToCart(id,tone,1);
          // animación breve
          $('#cartFloat').animate([{transform:'scale(1)'},{transform:'scale(1.08)'},{transform:'scale(1)'}],{duration:240});
        });
      });
    }

    /**************************************************************************
     * Abrir/cerrar carrito modal
     **************************************************************************/
    $('#cartFloat').addEventListener('click',()=>{ $('#overlay').style.display='flex'; renderCartModal(); });
    $('#closeCart').addEventListener('click',()=>{ $('#overlay').style.display='none'; });
    $('#overlay').addEventListener('click',e=>{ if(e.target===$('#overlay')) $('#overlay').style.display='none'; });

    // Sincronizar selects del menú lateral con modal
    $('#citySelect').addEventListener('change',e=>{ $('#citySelectModal').value = e.target.value; updateTotals(); });
    $('#methodSelect').addEventListener('change',e=>{ $('#methodSelectModal').value = e.target.value; updateTotals(); });
    $('#citySelectModal').addEventListener('change',updateTotals);
    $('#methodSelectModal').addEventListener('change',updateTotals);

    /**************************************************************************
     * Enviar por WhatsApp: generar mensaje con todo
     **************************************************************************/
    $('#sendWhats').addEventListener('click',()=>{
      const name = encodeURIComponent($('#customerName').value || '');
      const phone = $('#customerPhone').value.trim();
      if(!phone){ alert('Por favor ingresa tu número (ej: 5939xxxxxxx)'); return; }
      if(cart.items.length===0){ alert('Tu carrito está vacío'); return; }

      const city = $('#citySelectModal').value;
      const method = $('#methodSelectModal').value;
      const subtotal = calcSubtotal();
      const shipping = getShipping(city,method);
      const total = subtotal + shipping;

      let message = `Hola, mi nombre es ${decodeURIComponent(name)}.%0AQuiero hacer un pedido:%0A`;
      cart.items.forEach(it=>{
        message += `– ${it.name} | Tono: ${it.tone} | Cant: ${it.qty} | P.u: ${format(it.price)}%0A`;
      });
      message += `%0ASubtotal: ${format(subtotal)}%0AEnvío (${city} / ${method}): ${format(shipping)}%0ATotal: ${format(total)}%0A%0ADatos de contacto:%0ANombre: ${decodeURIComponent(name)}%0ATeléfono: ${phone}`;

      // Número de la tienda: reemplaza con tu número (sin +)
      const tiendaPhone = '593999999999';
      const url = `https://api.whatsapp.com/send?phone=${tiendaPhone}&text=${message}`;
      window.open(url,'_blank');
    });

    /**************************************************************************
     * Menú lateral filtros y búsqueda
     **************************************************************************/
    $$('.subcat button').forEach(b=>b.addEventListener('click',e=>{
      const sub = e.currentTarget.dataset.sub;
      // scroll a la sección
      const target = document.querySelector(`.seccion[data-subsection="${sub}"]`);
      if(target) target.scrollIntoView({behavior:'smooth',block:'center'});
    }));

    $('#search').addEventListener('input',e=>{
      const q = e.target.value.toLowerCase();
      $$('.card').forEach(card=>{
        const name = card.dataset.name.toLowerCase();
        const cat = card.dataset.subcategory.toLowerCase();
        if(name.includes(q) || cat.includes(q)) card.style.display='flex'; else card.style.display='none';
      });
    });

    /**************************************************************************
     * Menu open/close for small screens
     **************************************************************************/
    $('#abrir-menu').addEventListener('click', () => {
  const menu = $('#sideMenu');
  if (window.innerWidth <= 900) {
    menu.classList.toggle('open');
  } else {
    menu.scrollIntoView({ behavior: 'smooth' });
  }
});
// Cerrar menú al seleccionar una subcategoría
$$('.subcat button').forEach(b => b.addEventListener('click', () => {
  if(window.innerWidth <= 900) {
    $('#sideMenu').classList.remove('open');
  }
}));

// Cerrar menú al hacer click fuera del menú y fuera del botón
document.addEventListener('click', (e) => {
  const menu = $('#sideMenu');
  const btn = $('#abrir-menu');
  if(window.innerWidth <= 900) {
    if(menu.classList.contains('open') && !menu.contains(e.target) && e.target !== btn) {
      menu.classList.remove('open');
    }
  }
});

    /**************************************************************************
     * Iniciar carruseles nativos: nada especial, solo habilitar scroll con botones laterales opcional
     **************************************************************************/
    // Attach add buttons and initial counts
    attachAddButtons();
    refreshCartCount();

    // Llenar selects en los cards desde PRODUCTS (si quisieras dinámica)
    // (Los cards ya tienen opciones estáticas en este ejemplo)

    // Actualizar totales si el modal está abierto y selects cambian
    // (ya enlazado más arriba)

    // Ajustes finales: close overlay on Escape
    window.addEventListener('keydown',e=>{ if(e.key==='Escape') $('#overlay').style.display='none'; });
window.addEventListener('load', () => {
      setTimeout(() => {
        document.body.classList.add('loaded');
      }, 2500);
    });
    document.querySelectorAll('.carrusel-contenedor').forEach(contenedor => {
  const track = contenedor.querySelector('.carrusel-track');
  const cards = Array.from(track.querySelectorAll('.card'));
  const btnLeft = contenedor.querySelector('.btn-flecha.left');
  const btnRight = contenedor.querySelector('.btn-flecha.right');

  const itemsPerPage = 2;
  let currentPage = 0;
  const totalPages = Math.ceil(cards.length / itemsPerPage);

  function showPage(page) {
    // Ocultar todo
    cards.forEach(card => card.style.display = 'none');

    // Mostrar solo los productos de la página actual
    const start = page * itemsPerPage;
    const end = start + itemsPerPage;
    cards.slice(start, end).forEach(card => card.style.display = 'block');

    // Habilitar/deshabilitar botones según página
    btnLeft.disabled = (page === 0);
    btnRight.disabled = (page === totalPages - 1);
  }

  btnLeft.addEventListener('click', () => {
    if(currentPage > 0) {
      currentPage--;
      showPage(currentPage);
    }
  });

  btnRight.addEventListener('click', () => {
    if(currentPage < totalPages - 1) {
      currentPage++;
      showPage(currentPage);
    }
  });

  // Mostrar los primeros 2 productos al cargar
  showPage(currentPage);
});


  </script>
  </body>
</html>
